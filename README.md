# Scraper News Website Documentation

## Table of Contents

1. [Project Overview](#project-overview)
2. [System Architecture](#system-architecture)
3. [Components](#components)
   - [Python Scraper](#python-scraper)
   - [Next.js Website](#nextjs-website)
4. [PM2 Configuration](#pm2-configuration)
5. [Execution Process](#execution-process)
6. [Development Workflow](#development-workflow)
7. [Deployment](#deployment)
8. [Maintenance and Monitoring](#maintenance-and-monitoring)
9. [Troubleshooting](#troubleshooting)

## Project Overview

The Scraper News Website is a dynamic web application that automatically collects and displays news articles from various sources. It consists of two main components: a Python-based web scraper and a Next.js frontend website. The system uses PM2 for process management, ensuring both components run continuously and reliably.

## System Architecture

The system is built with a microservices architecture:

1. **Python Scraper**: A backend service that periodically scrapes news websites, processes the data, and stores it in a JSON file.
2. **Next.js Website**: A frontend application that reads the JSON file and presents the news articles in a user-friendly interface.
3. **PM2**: A process manager that runs and monitors both the scraper and the website.

## Components

### Python Scraper

The Python scraper is responsible for collecting news articles from predefined sources.

Key features:

- Utilizes libraries like `requests`, `BeautifulSoup`, and `newspaper3k` for web scraping.
- Periodically visits news websites and extracts article information.
- Processes and cleans the extracted data.
- Stores the collected articles in a `data.json` file.
- Implements error handling and logging for reliability.

File structure:

```
./
├── scraper.py
├── requirements.txt
└── .venv/
```

### Next.js Website

The Next.js website serves as the frontend for displaying the scraped news articles.

Key features:

- Reads the `data.json` file generated by the scraper.
- Presents articles in a responsive, user-friendly interface.
- Implements server-side rendering for improved performance and SEO.
- Provides filtering and search functionality for articles.

File structure:

```
./ai-website/
├── pages/
├── components/
├── public/
├── styles/
├── package.json
└── next.config.js
```

## PM2 Configuration

PM2 is used to manage both the Python scraper and the Next.js website. The configuration is defined in `ecosystem.config.js`:

```javascript
module.exports = {
  apps: [
    {
      name: "nextjs-app",
      script: "npm",
      args: "start",
      cwd: "./ai-website",
      env: {
        NODE_ENV: "production",
      },
    },
    {
      name: "python-scraper",
      script: ".venv/bin/python",
      args: "scraper.py",
      cwd: "./",
      interpreter: "none",
      env: {
        PYTHONUNBUFFERED: "1",
      },
      error_file: "logs/scraper-error.log",
      out_file: "logs/scraper-out.log",
      log_file: "logs/scraper-combined.log",
      time: true,
    },
  ],
};
```

This configuration:

- Defines two apps: `nextjs-app` and `python-scraper`.
- Specifies the working directory, start command, and environment variables for each app.
- Sets up logging for the Python scraper.

## Execution Process

The execution process involves several steps:

1. **System Preparation**:

   - Install required system packages (Python, Node.js, etc.).
   - Set up a Python virtual environment.
   - Install global npm packages (PM2, TypeScript, ts-node).

2. **Application Setup**:

   - Install Python dependencies from `requirements.txt`.
   - Install Node.js dependencies for the Next.js app.
   - Build the Next.js application.

3. **PM2 Initialization**:

   - Start both applications using the PM2 ecosystem file.
   - Set up PM2 to start on system boot.

4. **Continuous Operation**:
   - The Python scraper runs periodically, updating `data.json`.
   - The Next.js website serves the latest data to users.
   - PM2 monitors both processes, restarting them if they crash.

## Development Workflow

1. **Scraper Development**:

   - Activate the virtual environment: `source .venv/bin/activate`
   - Make changes to `scraper.py`
   - Test the scraper: `python scraper.py`
   - Update `requirements.txt` if new dependencies are added

2. **Website Development**:

   - Navigate to the Next.js directory: `cd ai-website`
   - Run the development server: `npm run dev`
   - Make changes and test in real-time

3. **Testing with PM2**:
   - Use the provided `test_pm2.sh` script to test PM2 configuration
   - Monitor logs and performance using PM2 commands

## Deployment

1. Ensure all changes are committed and pushed to the repository.
2. On the hosting platform, pull the latest changes.
3. Run the build script: `./build.sh`
4. The build script will:
   - Set up the environment
   - Install dependencies
   - Build the Next.js app
   - Start the applications using PM2

## Maintenance and Monitoring

- Regularly check PM2 logs: `pm2 logs`
- Monitor application status: `pm2 monit`
- Update dependencies periodically and test thoroughly
- Review and update the list of news sources in the scraper as needed
- Implement alerts for any critical errors or prolonged downtime

## Troubleshooting

Common issues and solutions:

1. **Scraper not updating data**:

   - Check scraper logs: `pm2 logs python-scraper`
   - Verify network connectivity
   - Ensure news source websites haven't changed their structure

2. **Next.js website not displaying latest news**:

   - Verify `data.json` is being updated
   - Check file permissions
   - Restart the Next.js app: `pm2 restart nextjs-app`

3. **PM2 processes crashing**:

   - Review error logs
   - Check for system resource constraints
   - Ensure all dependencies are correctly installed

4. **High server load**:
   - Optimize scraper frequency
   - Implement caching in the Next.js app
   - Consider scaling hardware resources

For any persistent issues, review the comprehensive logs, check system resources, and consider reaching out to the development team or consulting the documentation of individual components (Python libraries, Next.js, PM2).
